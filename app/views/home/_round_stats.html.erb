<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th width="22%">Nick</th>
      <th width="13%">Kils</th>
      <th width="13%">Deaths</th>
      <th width="9%">K:D</th>
      <th width="13%">% Hits</th>
      <th width="13%">% Headshots</th>
      <th width="27%">Time played</th>
    </tr>
  </thead>
  <tbody>
    <tr>
    <td colspan="7"><strong><font color="red">Terrorists - <%= @ts.count %> players</font></strong></td>
    </tr>
    <% @ts.sort_by{|e| -e[:kills]}.each do |player| %>
    <% reg_player = PermaStat.find_by_setinfo_pass(player.setinfo_pass) %>
    <tr>
      <td><%= if reg_player then link_to(player.name, "p/".concat(reg_player.name.parameterize.underscore), :class => "popover-with-html", :title => reg_player.name, "data-content" => "</font>
	<font size=\"1\">
	<table>
	  <thead>
	    <tr>
	      <th width=\"40px\">Kills</th>
	      <th width=\"40px\">Deaths</th>
	      <th width=\"55px\">% Hits</th>
	      <th width=\"45px\">% HS</th>
	    </tr>
	  </thead>
	  <tbody>
	    <tr>
	      <td>#{reg_player.kills}</td>
	      <td>#{reg_player.deaths}</td>
	      <td>#{(100*reg_player.hits.to_f/reg_player.shots).round(2)}</td>
	      <td>#{(100*reg_player.headshots.to_f/reg_player.shots).round(2)}</td>
	    </tr>
	  </tbody>
	</table><div align=\"center\">
	#{reg_player.time.round(1)} hrs</div>
	</font>
	") else player.name end %></td>
      <td><%= player.kills %></td>
      <td><%= player.deaths %></td>
      <td><%= (player.kills.to_f/player.deaths).round(1) %></td>
      <td><%= (100 * player.hits.to_f/player.shots).round(2) %></td>
      <td><%= (100 * player.headshots.to_f/player.shots).round(2) %></td>
      <td><%= if (time=player.time/60)<60 then "#{time} mins" else "#{(time.to_f/60).round(1)} hrs" end %></td>
    </tr>
    <% end %>
    <tr>
    <td colspan="7" align="center"><strong><font color="blue">Counter Terrorists - <%= @cts.count %> players</font></strong></td>
    </tr>
    <% @cts.sort_by{|e| -e[:kills]}.each do |player| %>
    <% reg_player = PermaStat.find_by_setinfo_pass(player.setinfo_pass) %>
    <tr>
      <td><%= if reg_player then link_to(player.name, "p/".concat(reg_player.name), :class => "popover-with-html", :title => reg_player.name, "data-content" => "</font>
	<font size=\"1\">
	<table>
	  <thead>
	    <tr>
	      <th width=\"40px\">Kills</th>
	      <th width=\"40px\">Deaths</th>
	      <th width=\"55px\">% Hits</th>
	      <th width=\"45px\">% HS</th>
	    </tr>
	  </thead>
	  <tbody>
	    <tr>
	      <td>#{reg_player.kills}</td>
	      <td>#{reg_player.deaths}</td>
	      <td>#{(100*reg_player.hits.to_f/reg_player.shots).round(2)}</td>
	      <td>#{(100*reg_player.headshots.to_f/reg_player.shots).round(2)}</td>
	    </tr>
	  </tbody>
	</table><div align=\"center\">
	#{reg_player.time.round(1)} hrs</div>
	</font>") else player.name end %></td>
      <td><%= player.kills %></td>
      <td><%= player.deaths %></td>
      <td><%= player.deaths == 0 ? 0 : (player.kills.to_f/player.deaths).round(2) %></td>
      <td><%= (100 * player.hits.to_f/player.shots).round(2) %></td>
      <td><%= (100 * player.headshots.to_f/player.shots).round(2) %></td>
      <td><%= if (time=player.time/60)<60 then "#{time} mins" else "#{(time.to_f/60).round(1)} hrs" end %></td>
    </tr>
    <% end %>
  </tbody>
</table>
